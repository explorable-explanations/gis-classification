{"version":3,"sources":["../../src/core/constants.ts","../../src/core/classification.ts","../../src/core/color-utils.ts","../../src/core/palettes.ts","../../src/core/format.ts","../../src/core/colorize.ts","../../src/core/histogram.ts","../../src/react/hooks/useClassifier.ts","../../src/react/hooks/usePaletteUI.ts","../../src/react/components/shared/Dropdown.tsx","../../src/react/components/HistogramChart.tsx","../../src/react/components/MethodSelector.tsx","../../src/react/components/PaletteStrip.tsx","../../src/react/components/shared/Switch.tsx","../../src/react/components/PaletteSelector.tsx","../../src/react/components/BreaksLegend.tsx","../../src/react/components/ClassifierPanel.tsx"],"names":["statBreaks","d3Format","color","d3Bin","useState","useCallback","useRef","useEffect","useMemo","range","jsx","jsxs"],"mappings":"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","file":"index.js","sourcesContent":["import type {ClassificationMethod} from './types';\n\nexport const CLASSIFICATION_METHODS: Record<ClassificationMethod, string> = {\n  quantile: '等量分類 (Quantile)',\n  equal: '等間隔分類 (Equal Interval)',\n  jenks: '自然分類 (Jenks)',\n  msd: '標準偏差 (Mean-Std Dev)',\n  geometric: '幾何学的分類 (Geometric)',\n  headtail: 'ヘッドテール分類 (Head/Tail)',\n  pretty: 'きりのよい分類 (Pretty)',\n  arithmetic: '等差分類 (Arithmetic)',\n  nestedmeans: '入れ子平均 (Nested Means)',\n  q6: 'Q6分類 (Q6)',\n  custom: 'カスタム (Custom)',\n};\n\nexport const SEQUENTIAL_SCHEMES = [\n  'Blues', 'Greens', 'Greys', 'Oranges', 'Purples', 'Reds',\n  'BuGn', 'BuPu', 'GnBu', 'OrRd', 'PuBu', 'PuBuGn',\n  'PuRd', 'RdPu', 'YlGn', 'YlGnBu', 'YlOrBr', 'YlOrRd',\n];\n\nexport const DIVERGING_SCHEMES = [\n  'BrBG', 'PiYG', 'PRGn', 'PuOr', 'RdBu', 'RdGy',\n  'RdYlBu', 'RdYlGn', 'Spectral',\n];\n\nexport const QUALITATIVE_SCHEMES = [\n  'Accent', 'Dark2', 'Paired', 'Pastel1', 'Pastel2',\n  'Set1', 'Set2', 'Set3', 'Tableau10',\n];\n\nexport const DEFAULT_METHOD: ClassificationMethod = 'quantile';\nexport const DEFAULT_NB_CLASSES = 5;\nexport const DEFAULT_PALETTE = 'Blues';\nexport const DEFAULT_MISSING_COLOR = '#f5f5f5';\nexport const DEFAULT_MISSING_TEXT = 'No data';\n","import type {ClassificationOptions, ClassificationResult} from './types';\nimport type {ClassificationMethod} from './types';\nimport {breaks as statBreaks} from 'statsbreaks';\n\nexport function classify(\n  data: number[],\n  options: ClassificationOptions\n): ClassificationResult {\n  const cleanData = data\n    .filter((d): d is number => d !== undefined && d !== null && !isNaN(+d) && d !== ('' as any));\n\n  if (cleanData.length === 0) {\n    return {breaks: [], innerBreaks: [], nClasses: 0};\n  }\n\n  // 'custom' is not a statsbreaks method; breaks are managed externally\n  if (options.method === 'custom') {\n    return {breaks: [], innerBreaks: [], nClasses: 0};\n  }\n\n  // nestedmeans requires nb to be a power of 2\n  let nb = options.nb;\n  if (options.method === 'nestedmeans' && nb !== undefined) {\n    const log2 = Math.log2(nb);\n    nb = Math.pow(2, Math.round(log2));\n    if (nb < 2) nb = 2;\n  }\n\n  const allBreaks = statBreaks(cleanData, {\n    method: options.method,\n    nb,\n    precision: options.precision,\n    k: options.k,\n    middle: options.middle,\n    minmax: true,\n  });\n\n  const innerBreaks = allBreaks.slice(1, -1);\n\n  return {\n    breaks: allBreaks,\n    innerBreaks,\n    nClasses: allBreaks.length - 1,\n  };\n}\n\nexport const METHODS: ClassificationMethod[] = [\n  'quantile', 'q6', 'equal', 'jenks', 'msd',\n  'geometric', 'headtail', 'pretty', 'arithmetic', 'nestedmeans',\n  'custom',\n];\n","import {color} from 'd3-color';\nimport type {HexColor} from './types';\n\nexport function colorToHex(c: string): HexColor {\n  const parsed = color(c);\n  if (!parsed) return c;\n  return parsed.formatHex();\n}\n\nexport function hexToRgb(hex: string): [number, number, number] {\n  const parsed = color(hex);\n  if (!parsed) return [0, 0, 0];\n  const rgb = parsed.rgb();\n  return [rgb.r, rgb.g, rgb.b];\n}\n","import * as d3sc from 'd3-scale-chromatic';\nimport {range} from 'd3-array';\nimport {colorToHex} from './color-utils';\nimport {SEQUENTIAL_SCHEMES, DIVERGING_SCHEMES, QUALITATIVE_SCHEMES} from './constants';\nimport type {PaletteEntry, PaletteType, HexColor} from './types';\n\nfunction buildPaletteEntry(name: string, type: PaletteType): PaletteEntry {\n  const scheme = (d3sc as any)[`scheme${name}`];\n  const interpolator = (d3sc as any)[`interpolate${name}`];\n\n  let maxClasses: number;\n  if (type === 'qualitative' && Array.isArray(scheme)) {\n    maxClasses = scheme.length;\n  } else if (Array.isArray(scheme)) {\n    maxClasses = scheme.length - 1;\n  } else {\n    maxClasses = 12;\n  }\n\n  return {\n    name,\n    type,\n    maxClasses,\n    colors: (n: number): HexColor[] => {\n      const clamped = Math.max(1, Math.min(n, maxClasses));\n      if (type === 'qualitative' && Array.isArray(scheme)) {\n        return scheme.slice(0, clamped).map(colorToHex);\n      }\n      if (Array.isArray(scheme) && scheme[clamped]) {\n        return [...scheme[clamped]].map(colorToHex);\n      }\n      if (interpolator) {\n        if (clamped === 1) return [colorToHex(interpolator(0.5))];\n        return range(clamped).map(i => colorToHex(interpolator(i / (clamped - 1))));\n      }\n      return [];\n    },\n  };\n}\n\nexport const ALL_PALETTES: PaletteEntry[] = [\n  ...SEQUENTIAL_SCHEMES.map(n => buildPaletteEntry(n, 'sequential')),\n  ...DIVERGING_SCHEMES.map(n => buildPaletteEntry(n, 'diverging')),\n  ...QUALITATIVE_SCHEMES.map(n => buildPaletteEntry(n, 'qualitative')),\n];\n\nexport function getPaletteByName(name: string): PaletteEntry | undefined {\n  return ALL_PALETTES.find(p => p.name === name);\n}\n\nexport function getPalettesByType(type: PaletteType | 'all'): PaletteEntry[] {\n  if (type === 'all') return ALL_PALETTES;\n  return ALL_PALETTES.filter(p => p.type === type);\n}\n","import {format as d3Format} from 'd3-format';\n\nexport function formatNumber(n: number): string {\n  if (!Number.isFinite(n)) return String(n);\n  const abs = Math.abs(n);\n  if (abs === 0) return '0';\n  if (abs < 1) return d3Format('.4~f')(n);\n  if (abs < 1000) return d3Format('.4~r')(n);\n  if (abs < 10000) return d3Format(',.2~f')(n);\n  return d3Format('.4~s')(n);\n}\n","import {scaleThreshold, scaleOrdinal} from 'd3-scale';\nimport {classify} from './classification';\nimport {getPaletteByName} from './palettes';\nimport {formatNumber} from './format';\nimport {DEFAULT_METHOD, DEFAULT_NB_CLASSES, DEFAULT_PALETTE, DEFAULT_MISSING_COLOR, DEFAULT_MISSING_TEXT} from './constants';\nimport type {ClassificationMethod, ColorizeResult, BreakLegendEntry, HexColor} from './types';\n\nexport function colorizeChoropleth(\n  values: number[],\n  options: {\n    method?: ClassificationMethod;\n    nClasses?: number;\n    palette?: string;\n    colors?: HexColor[];\n    breaks?: number[];\n    precision?: number;\n    k?: number;\n    middle?: boolean;\n    reversed?: boolean;\n    missingColor?: HexColor;\n    missingText?: string;\n  } = {}\n): ColorizeResult {\n  const method = options.method ?? DEFAULT_METHOD;\n  const nClasses = options.nClasses ?? DEFAULT_NB_CLASSES;\n  const missingColor = options.missingColor ?? DEFAULT_MISSING_COLOR;\n  const missingText = options.missingText ?? DEFAULT_MISSING_TEXT;\n\n  let allBreaks: number[];\n  if (options.breaks) {\n    allBreaks = [...options.breaks].sort((a, b) => a - b);\n  } else {\n    const result = classify(values, {\n      method,\n      nb: nClasses,\n      precision: options.precision,\n      k: options.k,\n      middle: options.middle,\n    });\n    allBreaks = result.breaks;\n  }\n\n  let colors: HexColor[];\n  if (options.colors) {\n    colors = options.colors;\n  } else {\n    const paletteName = options.palette ?? DEFAULT_PALETTE;\n    const entry = getPaletteByName(paletteName);\n    colors = entry ? entry.colors(allBreaks.length - 1) : [];\n  }\n\n  if (options.reversed) {\n    colors = [...colors].reverse();\n  }\n\n  const innerBreaks = allBreaks.slice(1, -1);\n\n  const scale = scaleThreshold<number, string>()\n    .domain(innerBreaks)\n    .range(colors)\n    .unknown(missingColor);\n\n  const hasMissing = values.some(v => v == null || v === ('' as any) || isNaN(+v));\n  const missing: [string, HexColor] | null = hasMissing ? [missingText, missingColor] : null;\n\n  return {\n    getColor: (value) => {\n      if (value === '' || value == null || isNaN(+(value as number))) {\n        return missingColor;\n      }\n      return scale(+(value as number));\n    },\n    breaks: allBreaks,\n    colors,\n    missing,\n  };\n}\n\nexport function breaksToLegend(breaks: number[], colors: HexColor[]): BreakLegendEntry[] {\n  if (breaks.length < 2 || colors.length === 0) return [];\n\n  return colors.map((color, i) => {\n    const lower = i === 0 ? null : breaks[i];\n    const upper = i === colors.length - 1 ? null : breaks[i + 1];\n    let label: string;\n    if (lower === null) {\n      label = `< ${formatNumber(breaks[1])}`;\n    } else if (upper === null) {\n      label = `${formatNumber(breaks[i])} +`;\n    } else {\n      label = `${formatNumber(lower)} - ${formatNumber(upper)}`;\n    }\n    return {color, label, range: [lower, upper]};\n  });\n}\n","import {bin as d3Bin, extent, mean} from 'd3-array';\nimport type {Bin} from './types';\n\nexport function computeHistogram(values: number[], numBins = 30): Bin[] {\n  const clean = values.filter(d => d != null && !isNaN(d));\n  if (clean.length === 0) return [];\n\n  const bins = d3Bin().thresholds(numBins)(clean);\n\n  return bins.map(b => ({\n    x0: b.x0 ?? 0,\n    x1: b.x1 ?? 0,\n    count: b.length,\n  }));\n}\n\nexport function getHistogramDomain(values: number[]): {min: number; max: number; mean: number} {\n  const clean = values.filter(d => d != null && !isNaN(d));\n  const [min, max] = extent(clean) as [number, number];\n  const avg = mean(clean) ?? 0;\n  return {min: min ?? 0, max: max ?? 0, mean: avg};\n}\n","import {useMemo, useState, useCallback} from 'react';\nimport type {\n  ClassificationMethod,\n  BreakLegendEntry,\n  HexColor,\n  Bin,\n  PaletteConfig,\n} from '../../core/types';\nimport {DEFAULT_METHOD, DEFAULT_NB_CLASSES, DEFAULT_PALETTE} from '../../core/constants';\nimport {classify} from '../../core/classification';\nimport {getPaletteByName} from '../../core/palettes';\nimport {breaksToLegend} from '../../core/colorize';\nimport {computeHistogram, getHistogramDomain} from '../../core/histogram';\n\nexport type UseClassifierOptions = {\n  data: number[];\n  method?: ClassificationMethod;\n  nClasses?: number;\n  palette?: string;\n  reversed?: boolean;\n  precision?: number;\n};\n\nexport type UseClassifierResult = {\n  breaks: number[];\n  colors: HexColor[];\n  legend: BreakLegendEntry[];\n  histogram: Bin[];\n  histogramDomain: {min: number; max: number; mean: number};\n  method: ClassificationMethod;\n  nClasses: number;\n  paletteName: string;\n  reversed: boolean;\n  setMethod: (method: ClassificationMethod) => void;\n  setNClasses: (n: number) => void;\n  setPalette: (name: string) => void;\n  setReversed: (reversed: boolean) => void;\n  isEditingCustomBreaks: boolean;\n  startEditCustomBreaks: () => void;\n  editBreakValue: (index: number, value: number) => void;\n  confirmCustomBreaks: () => void;\n  cancelCustomBreaks: () => void;\n};\n\nexport function useClassifier(options: UseClassifierOptions): UseClassifierResult {\n  const {data, precision} = options;\n\n  const [method, setMethodInternal] = useState<ClassificationMethod>(options.method ?? DEFAULT_METHOD);\n  const [nClasses, setNClasses] = useState(options.nClasses ?? DEFAULT_NB_CLASSES);\n  const [paletteName, setPalette] = useState(options.palette ?? DEFAULT_PALETTE);\n  const [reversed, setReversed] = useState(options.reversed ?? false);\n  const [isEditingCustomBreaks, setIsEditingCustomBreaks] = useState(false);\n  const [customBreaks, setCustomBreaks] = useState<number[] | null>(null);\n  // Store the last non-custom method so we can use its breaks as the starting point for custom\n  const [lastAutoMethod, setLastAutoMethod] = useState<ClassificationMethod>(\n    (options.method ?? DEFAULT_METHOD) === 'custom' ? DEFAULT_METHOD : (options.method ?? DEFAULT_METHOD)\n  );\n\n  // Compute breaks from automatic methods (used as base when switching to custom)\n  const autoBreaks = useMemo(() => {\n    if (!data || data.length === 0) return [];\n    const m = method === 'custom' ? lastAutoMethod : method;\n    try {\n      return classify(data, {method: m, nb: nClasses, precision}).breaks;\n    } catch {\n      return [];\n    }\n  }, [data, method, lastAutoMethod, nClasses, precision]);\n\n  const classResult = useMemo(() => {\n    if (!data || data.length === 0) return {breaks: [], innerBreaks: [], nClasses: 0};\n    if (method === 'custom' && customBreaks) {\n      return {\n        breaks: customBreaks,\n        innerBreaks: customBreaks.slice(1, -1),\n        nClasses: customBreaks.length - 1,\n      };\n    }\n    if (customBreaks) {\n      return {\n        breaks: customBreaks,\n        innerBreaks: customBreaks.slice(1, -1),\n        nClasses: customBreaks.length - 1,\n      };\n    }\n    try {\n      return classify(data, {method: method === 'custom' ? lastAutoMethod : method, nb: nClasses, precision});\n    } catch {\n      return {breaks: [], innerBreaks: [], nClasses: 0};\n    }\n  }, [data, method, lastAutoMethod, nClasses, precision, customBreaks]);\n\n  const colors = useMemo(() => {\n    if (classResult.nClasses === 0) return [];\n    const entry = getPaletteByName(paletteName);\n    const c = entry ? entry.colors(classResult.nClasses) : [];\n    return reversed ? [...c].reverse() : c;\n  }, [paletteName, classResult.nClasses, reversed]);\n\n  const legend = useMemo(() => {\n    return breaksToLegend(classResult.breaks, colors);\n  }, [classResult.breaks, colors]);\n\n  const histogram = useMemo(() => {\n    if (!data || data.length === 0) return [];\n    return computeHistogram(data, 30);\n  }, [data]);\n\n  const histogramDomain = useMemo(() => {\n    if (!data || data.length === 0) return {min: 0, max: 0, mean: 0};\n    return getHistogramDomain(data);\n  }, [data]);\n\n  const setMethod = useCallback(\n    (newMethod: ClassificationMethod) => {\n      if (newMethod === 'custom') {\n        // Switching to custom: use current breaks as starting point for editing\n        const baseBreaks = classResult.breaks.length > 0 ? [...classResult.breaks] : autoBreaks.length > 0 ? [...autoBreaks] : null;\n        setCustomBreaks(baseBreaks);\n        setIsEditingCustomBreaks(true);\n      } else {\n        // Switching away from custom: clear custom state\n        setLastAutoMethod(newMethod);\n        setCustomBreaks(null);\n        setIsEditingCustomBreaks(false);\n      }\n      setMethodInternal(newMethod);\n    },\n    [classResult.breaks, autoBreaks]\n  );\n\n  const startEditCustomBreaks = useCallback(() => {\n    setCustomBreaks(classResult.breaks.length > 0 ? [...classResult.breaks] : null);\n    setIsEditingCustomBreaks(true);\n  }, [classResult.breaks]);\n\n  const editBreakValue = useCallback(\n    (index: number, value: number) => {\n      if (!customBreaks) return;\n      const newBreaks = [...customBreaks];\n      if (index >= 0 && index < newBreaks.length) {\n        newBreaks[index] = value;\n      }\n      newBreaks.sort((a, b) => a - b);\n      setCustomBreaks(newBreaks);\n    },\n    [customBreaks]\n  );\n\n  const confirmCustomBreaks = useCallback(() => {\n    setIsEditingCustomBreaks(false);\n  }, []);\n\n  const cancelCustomBreaks = useCallback(() => {\n    if (method === 'custom') {\n      // Cancel in custom mode: revert to auto breaks but stay in custom method\n      const baseBreaks = autoBreaks.length > 0 ? [...autoBreaks] : null;\n      setCustomBreaks(baseBreaks);\n      setIsEditingCustomBreaks(false);\n    } else {\n      setIsEditingCustomBreaks(false);\n      setCustomBreaks(null);\n    }\n  }, [method, autoBreaks]);\n\n  return {\n    breaks: classResult.breaks,\n    colors,\n    legend,\n    histogram,\n    histogramDomain,\n    method,\n    nClasses,\n    paletteName,\n    reversed,\n    setMethod,\n    setNClasses,\n    setPalette,\n    setReversed,\n    isEditingCustomBreaks,\n    startEditCustomBreaks,\n    editBreakValue,\n    confirmCustomBreaks,\n    cancelCustomBreaks,\n  };\n}\n","import {useState, useCallback} from 'react';\nimport type {PaletteConfig, PaletteType} from '../../core/types';\n\nexport type UsePaletteUIOptions = {\n  initialConfig?: Partial<PaletteConfig>;\n};\n\nexport function usePaletteUI(options: UsePaletteUIOptions = {}) {\n  const [config, setConfigState] = useState<PaletteConfig>({\n    type: 'all',\n    steps: 5,\n    reversed: false,\n    ...options.initialConfig,\n  });\n\n  const setConfig = useCallback((partial: Partial<PaletteConfig>) => {\n    setConfigState((prev) => ({...prev, ...partial}));\n  }, []);\n\n  return {\n    config,\n    setConfig,\n  };\n}\n","import React, {useState, useRef, useEffect} from 'react';\n\ntype DropdownProps<T> = {\n  options: T[];\n  value: T;\n  onChange: (value: T) => void;\n  getLabel?: (option: T) => string;\n  getValue?: (option: T) => string;\n  disabled?: boolean;\n  placeholder?: string;\n};\n\nexport function Dropdown<T>({\n  options,\n  value,\n  onChange,\n  getLabel = (o: T) => String(o),\n  getValue = (o: T) => String(o),\n  disabled,\n  placeholder,\n}: DropdownProps<T>) {\n  const [isOpen, setIsOpen] = useState(false);\n  const ref = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      if (ref.current && !ref.current.contains(e.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  return (\n    <div ref={ref} style={{position: 'relative', width: '100%', minWidth: '80px'}}>\n      <button\n        type=\"button\"\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          width: '100%',\n          padding: '4px 8px',\n          border: '1px solid var(--sb-border, #3a4552)',\n          borderRadius: 'var(--sb-radius, 4px)',\n          backgroundColor: 'var(--sb-input-bg, #29323c)',\n          color: 'var(--sb-text-primary, #a0a7b4)',\n          fontSize: 'var(--sb-font-size-sm, 11px)',\n          cursor: disabled ? 'not-allowed' : 'pointer',\n          opacity: disabled ? 0.5 : 1,\n        }}\n        onClick={() => !disabled && setIsOpen(!isOpen)}\n        disabled={disabled}\n      >\n        <span>{value ? getLabel(value) : placeholder || 'Select...'}</span>\n        <span style={{marginLeft: '4px'}}>&#9662;</span>\n      </button>\n      {isOpen && (\n        <ul\n          style={{\n            position: 'absolute',\n            top: '100%',\n            left: 0,\n            right: 0,\n            zIndex: 100,\n            maxHeight: '200px',\n            overflowY: 'auto',\n            backgroundColor: 'var(--sb-dropdown-bg, #3a4552)',\n            border: '1px solid var(--sb-border, #3a4552)',\n            borderRadius: 'var(--sb-radius, 4px)',\n            boxShadow: 'var(--sb-dropdown-shadow, 0 4px 12px rgba(0,0,0,0.3))',\n            margin: '2px 0 0 0',\n            padding: 0,\n            listStyle: 'none',\n          }}\n        >\n          {options.map((option) => (\n            <li\n              key={getValue(option)}\n              style={{\n                padding: '6px 8px',\n                cursor: 'pointer',\n                fontSize: 'var(--sb-font-size-sm, 11px)',\n                color: 'var(--sb-text-primary, #a0a7b4)',\n                backgroundColor:\n                  getValue(option) === getValue(value) ? 'var(--sb-bg-hover, #4a5668)' : 'transparent',\n              }}\n              onMouseEnter={(e) => {\n                (e.target as HTMLElement).style.backgroundColor = 'var(--sb-bg-hover, #4a5668)';\n              }}\n              onMouseLeave={(e) => {\n                if (getValue(option) !== getValue(value)) {\n                  (e.target as HTMLElement).style.backgroundColor = 'transparent';\n                }\n              }}\n              onClick={() => {\n                onChange(option);\n                setIsOpen(false);\n              }}\n            >\n              {getLabel(option)}\n            </li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n}\n","import React, {useMemo, useRef, useState, useEffect} from 'react';\nimport type {Bin, BreakLegendEntry, HexColor} from '../../core/types';\n\nconst MARGIN = {top: 18, bottom: 4, left: 10, right: 20};\n\nexport type HistogramChartProps = {\n  bins: Bin[];\n  legend?: BreakLegendEntry[];\n  colors?: HexColor[];\n  breaks?: number[];\n  width?: number;\n  height?: number;\n  domain?: {min: number; max: number; mean?: number};\n};\n\nexport const HistogramChart: React.FC<HistogramChartProps> = ({\n  bins,\n  legend,\n  colors,\n  breaks,\n  width: widthProp,\n  height = 80,\n  domain,\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [measuredWidth, setMeasuredWidth] = useState(widthProp ?? 210);\n\n  useEffect(() => {\n    if (widthProp !== undefined) return;\n    const el = containerRef.current;\n    if (!el) return;\n    const observer = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        setMeasuredWidth(entry.contentRect.width);\n      }\n    });\n    observer.observe(el);\n    setMeasuredWidth(el.clientWidth);\n    return () => observer.disconnect();\n  }, [widthProp]);\n\n  const width = widthProp ?? measuredWidth;\n  const innerWidth = width - MARGIN.left - MARGIN.right;\n  const innerHeight = height - MARGIN.top - MARGIN.bottom;\n\n  const {xScale, yScale, domainMin, domainMax} = useMemo(() => {\n    if (!bins.length) {\n      return {\n        xScale: () => 0,\n        yScale: () => innerHeight,\n        domainMin: 0,\n        domainMax: 0,\n      };\n    }\n    const min = domain ? domain.min : bins[0].x0;\n    const max = domain ? domain.max : bins[bins.length - 1].x1;\n    const maxCount = Math.max(...bins.map((b) => b.count), 1);\n    const range = max - min || 1;\n\n    return {\n      xScale: (v: number) => ((v - min) / range) * innerWidth,\n      yScale: (v: number) => innerHeight - (v / maxCount) * innerHeight,\n      domainMin: min,\n      domainMax: max,\n    };\n  }, [bins, innerWidth, innerHeight, domain]);\n\n  const displayColors = colors || legend?.map((e) => e.color) || [];\n\n  const getColorForValue = (value: number): string => {\n    if (!breaks || breaks.length < 2 || displayColors.length === 0) {\n      return 'var(--sb-accent, #5b8ef4)';\n    }\n    const innerBreaks = breaks.slice(1, -1);\n    for (let i = innerBreaks.length - 1; i >= 0; i--) {\n      if (value >= innerBreaks[i]) return displayColors[i + 1] || displayColors[displayColors.length - 1];\n    }\n    return displayColors[0];\n  };\n\n  return (\n    <div ref={containerRef} style={{marginTop: '8px', width: '100%'}}>\n      <svg width={width} height={height}>\n        <g transform={`translate(${MARGIN.left},${MARGIN.top})`}>\n          {bins.map((bin, i) => {\n            const barX = xScale(bin.x0);\n            const barWidth = Math.max(xScale(bin.x1) - barX, 1);\n            const barHeight = innerHeight - yScale(bin.count);\n            return (\n              <rect\n                key={`bg-${i}`}\n                x={barX}\n                y={yScale(bin.count)}\n                width={barWidth}\n                height={barHeight}\n                fill=\"var(--sb-bg-hover, #4a5668)\"\n                opacity={0.4}\n              />\n            );\n          })}\n          {bins.map((bin, i) => {\n            const barX = xScale(bin.x0);\n            const barWidth = Math.max(xScale(bin.x1) - barX, 1);\n            const barHeight = innerHeight - yScale(bin.count);\n            const midPoint = (bin.x0 + bin.x1) / 2;\n            return (\n              <rect\n                key={`fg-${i}`}\n                x={barX}\n                y={yScale(bin.count)}\n                width={barWidth}\n                height={barHeight}\n                fill={getColorForValue(midPoint)}\n                opacity={0.8}\n              />\n            );\n          })}\n          {breaks && breaks.length > 2 &&\n            breaks.slice(1, -1).map((brk, i) => {\n              const x = xScale(brk);\n              return (\n                <g key={`brk-${i}`}>\n                  <line\n                    x1={x}\n                    x2={x}\n                    y1={-4}\n                    y2={innerHeight}\n                    stroke=\"#000\"\n                    strokeWidth={1}\n                    opacity={0.6}\n                  />\n                  <text\n                    x={x}\n                    y={-6}\n                    textAnchor=\"middle\"\n                    fontSize=\"7px\"\n                    fill=\"var(--sb-text-secondary, #6a7485)\"\n                  >\n                    {brk % 1 === 0 ? brk : brk.toFixed(1)}\n                  </text>\n                </g>\n              );\n            })}\n        </g>\n      </svg>\n    </div>\n  );\n};\n","import React, {useMemo, useCallback} from 'react';\nimport type {ClassificationMethod, Bin, BreakLegendEntry, HexColor} from '../../core/types';\nimport {CLASSIFICATION_METHODS} from '../../core/constants';\nimport {Dropdown} from './shared/Dropdown';\nimport {HistogramChart} from './HistogramChart';\n\ntype MethodOption = {\n  label: string;\n  value: ClassificationMethod;\n};\n\nconst METHOD_OPTIONS: MethodOption[] = Object.entries(CLASSIFICATION_METHODS).map(\n  ([value, label]) => ({label, value: value as ClassificationMethod})\n);\n\nexport type MethodSelectorProps = {\n  method: ClassificationMethod;\n  bins?: Bin[];\n  breaks?: number[];\n  legend?: BreakLegendEntry[];\n  colors?: HexColor[];\n  histogramDomain?: {min: number; max: number; mean?: number};\n  onSelectMethod: (method: ClassificationMethod) => void;\n  disabled?: boolean;\n};\n\nexport const MethodSelector: React.FC<MethodSelectorProps> = ({\n  method,\n  bins,\n  breaks,\n  legend,\n  colors,\n  histogramDomain,\n  onSelectMethod,\n  disabled,\n}) => {\n  const selectedOption = useMemo(\n    () => METHOD_OPTIONS.find((o) => o.value === method) || METHOD_OPTIONS[0],\n    [method]\n  );\n\n  const handleSelect = useCallback(\n    (option: MethodOption) => {\n      onSelectMethod(option.value);\n    },\n    [onSelectMethod]\n  );\n\n  return (\n    <div style={{fontFamily: 'var(--sb-font-family)'}}>\n      <div\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          marginBottom: '8px',\n          fontSize: 'var(--sb-font-size-sm, 11px)',\n          color: 'var(--sb-text-primary, #a0a7b4)',\n        }}\n      >\n        <span>Method</span>\n        <div style={{width: '80%'}}>\n          <Dropdown\n            options={METHOD_OPTIONS}\n            value={selectedOption}\n            onChange={handleSelect}\n            getLabel={(o) => o.label}\n            getValue={(o) => o.value}\n            disabled={disabled}\n          />\n        </div>\n      </div>\n\n      {bins && bins.length > 0 && (\n        <HistogramChart\n          bins={bins}\n          legend={legend}\n          colors={colors}\n          breaks={breaks}\n          domain={histogramDomain}\n        />\n      )}\n    </div>\n  );\n};\n","import React from 'react';\nimport type {HexColor} from '../../core/types';\n\nexport type PaletteStripProps = {\n  colors: HexColor[];\n  height?: number;\n  isSelected?: boolean;\n  onClick?: (e: React.MouseEvent) => void;\n};\n\nexport const PaletteStrip: React.FC<PaletteStripProps> = ({\n  colors,\n  height = 10,\n  isSelected = false,\n  onClick,\n}) => {\n  return (\n    <div\n      onClick={onClick}\n      style={{\n        display: 'flex',\n        height: `${height}px`,\n        cursor: onClick ? 'pointer' : 'default',\n        borderRadius: '2px',\n        overflow: 'hidden',\n        outline: isSelected ? '2px solid var(--sb-accent, #5b8ef4)' : 'none',\n        outlineOffset: '1px',\n      }}\n    >\n      {colors.map((color, i) => (\n        <div key={`${color}-${i}`} style={{flex: 1, backgroundColor: color}} />\n      ))}\n    </div>\n  );\n};\n","import React from 'react';\n\ntype SwitchProps = {\n  checked: boolean;\n  onChange: (checked: boolean) => void;\n  label?: string;\n  disabled?: boolean;\n};\n\nexport const Switch: React.FC<SwitchProps> = ({checked, onChange, label, disabled}) => {\n  return (\n    <label\n      style={{\n        display: 'inline-flex',\n        alignItems: 'center',\n        gap: '8px',\n        cursor: disabled ? 'not-allowed' : 'pointer',\n        opacity: disabled ? 0.5 : 1,\n        fontSize: 'var(--sb-font-size-md, 12px)',\n        color: 'var(--sb-text-primary, #a0a7b4)',\n      }}\n    >\n      {label && <span>{label}</span>}\n      <span\n        onClick={(e) => {\n          e.preventDefault();\n          if (!disabled) onChange(!checked);\n        }}\n        style={{\n          position: 'relative',\n          display: 'inline-block',\n          width: '32px',\n          height: '18px',\n          borderRadius: '9px',\n          backgroundColor: checked\n            ? 'var(--sb-switch-on, #5b8ef4)'\n            : 'var(--sb-switch-off, #6a7485)',\n          transition: 'background-color 0.2s',\n        }}\n      >\n        <span\n          style={{\n            position: 'absolute',\n            top: '2px',\n            left: checked ? '16px' : '2px',\n            width: '14px',\n            height: '14px',\n            borderRadius: '50%',\n            backgroundColor: '#fff',\n            transition: 'left 0.2s',\n          }}\n        />\n      </span>\n    </label>\n  );\n};\n","import React, {useMemo, useCallback} from 'react';\nimport {range} from 'd3-array';\nimport type {PaletteType, PaletteConfig, PaletteEntry} from '../../core/types';\nimport {ALL_PALETTES, getPalettesByType} from '../../core/palettes';\nimport {PaletteStrip} from './PaletteStrip';\nimport {Dropdown} from './shared/Dropdown';\nimport {Switch} from './shared/Switch';\n\nconst TYPE_OPTIONS = ['all', 'sequential', 'diverging', 'qualitative'] as const;\nconst STEP_OPTIONS = range(3, 10);\n\nexport type PaletteSelectorProps = {\n  selectedPalette: string;\n  config: PaletteConfig;\n  onSelectPalette: (name: string) => void;\n  onConfigChange: (config: Partial<PaletteConfig>) => void;\n};\n\nexport const PaletteSelector: React.FC<PaletteSelectorProps> = ({\n  selectedPalette,\n  config,\n  onSelectPalette,\n  onConfigChange,\n}) => {\n  const {type, steps, reversed} = config;\n\n  const filteredPalettes = useMemo(() => {\n    return getPalettesByType(type).filter((p) => p.maxClasses >= steps);\n  }, [type, steps]);\n\n  const configRowStyle: React.CSSProperties = {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: '8px',\n    fontSize: 'var(--sb-font-size-sm, 11px)',\n    color: 'var(--sb-text-primary, #a0a7b4)',\n  };\n\n  return (\n    <div style={{fontFamily: 'var(--sb-font-family)', color: 'var(--sb-text-primary, #a0a7b4)'}}>\n      <div style={{padding: '12px 12px 0 12px'}}>\n        <div style={configRowStyle}>\n          <span>Type</span>\n          <div style={{width: '40%'}}>\n            <Dropdown\n              options={[...TYPE_OPTIONS]}\n              value={type}\n              onChange={(val) => onConfigChange({type: val as PaletteType | 'all'})}\n              getLabel={(v) => v.charAt(0).toUpperCase() + v.slice(1)}\n              getValue={(v) => v}\n            />\n          </div>\n        </div>\n\n        <div style={configRowStyle}>\n          <span>Steps</span>\n          <div style={{width: '40%'}}>\n            <Dropdown\n              options={STEP_OPTIONS}\n              value={steps}\n              onChange={(val) => onConfigChange({steps: val})}\n              getLabel={(v) => String(v)}\n              getValue={(v) => String(v)}\n            />\n          </div>\n        </div>\n\n        <div style={configRowStyle}>\n          <span>Reversed</span>\n          <div style={{width: '40%'}}>\n            <Switch checked={reversed} onChange={(val) => onConfigChange({reversed: val})} />\n          </div>\n        </div>\n      </div>\n\n      <div style={{maxHeight: '200px', overflowY: 'auto', padding: '0 8px 8px 8px'}}>\n        {filteredPalettes.map((palette) => {\n          const paletteColors = reversed\n            ? [...palette.colors(steps)].reverse()\n            : palette.colors(steps);\n          const isSelected = palette.name === selectedPalette;\n          return (\n            <div\n              key={palette.name}\n              style={{padding: '4px 0', cursor: 'pointer'}}\n              title={palette.name}\n            >\n              <PaletteStrip\n                colors={paletteColors}\n                height={12}\n                isSelected={isSelected}\n                onClick={() => onSelectPalette(palette.name)}\n              />\n            </div>\n          );\n        })}\n        {filteredPalettes.length === 0 && (\n          <div\n            style={{\n              padding: '12px',\n              textAlign: 'center',\n              fontSize: '11px',\n              color: 'var(--sb-text-secondary)',\n            }}\n          >\n            No matching palettes found\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n","import React, {useState, useCallback, useRef, useEffect} from 'react';\nimport type {BreakLegendEntry} from '../../core/types';\n\nexport type BreaksLegendProps = {\n  legend: BreakLegendEntry[];\n  isEditing?: boolean;\n  onEdit?: () => void;\n  onEditValue?: (index: number, value: number) => void;\n  onConfirm?: () => void;\n  onCancel?: () => void;\n};\n\nconst SwatchStyle: React.CSSProperties = {\n  width: '16px',\n  height: '16px',\n  borderRadius: '2px',\n  marginRight: '8px',\n  flexShrink: 0,\n};\n\nconst RowStyle: React.CSSProperties = {\n  display: 'flex',\n  alignItems: 'center',\n  padding: '3px 0',\n  fontSize: 'var(--sb-font-size-sm, 11px)',\n  color: 'var(--sb-text-primary, #a0a7b4)',\n};\n\nconst ThresholdInput: React.FC<{\n  value: number | null;\n  placeholder?: string;\n  disabled?: boolean;\n  onChange: (val: number) => void;\n}> = ({value, placeholder, disabled, onChange}) => {\n  const [localValue, setLocalValue] = useState(\n    value !== null && Number.isFinite(value) ? String(value) : ''\n  );\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    setLocalValue(value !== null && Number.isFinite(value) ? String(value) : '');\n  }, [value]);\n\n  const applyValue = useCallback(() => {\n    const parsed = parseFloat(localValue);\n    if (!isNaN(parsed) && Number.isFinite(parsed)) {\n      onChange(parsed);\n    }\n  }, [localValue, onChange]);\n\n  const onKeyDown = useCallback(\n    (e: React.KeyboardEvent) => {\n      if (e.key === 'Enter') {\n        applyValue();\n        inputRef.current?.blur();\n      }\n    },\n    [applyValue]\n  );\n\n  if (disabled) {\n    return (\n      <span\n        style={{\n          display: 'inline-block',\n          width: '60px',\n          textAlign: 'right',\n          color: 'var(--sb-text-secondary, #6a7485)',\n          fontSize: 'var(--sb-font-size-sm, 11px)',\n        }}\n      >\n        {placeholder || ''}\n      </span>\n    );\n  }\n\n  return (\n    <input\n      ref={inputRef}\n      type=\"text\"\n      value={localValue}\n      onChange={(e) => setLocalValue(e.target.value)}\n      onBlur={applyValue}\n      onKeyDown={onKeyDown}\n      style={{\n        width: '60px',\n        background: 'var(--sb-bg-secondary, #3a4552)',\n        color: 'var(--sb-text-primary, #a0a7b4)',\n        border: '1px solid var(--sb-border, #4a5668)',\n        borderRadius: '3px',\n        padding: '2px 4px',\n        fontSize: 'var(--sb-font-size-sm, 11px)',\n        textAlign: 'right',\n        outline: 'none',\n      }}\n    />\n  );\n};\n\nexport const BreaksLegend: React.FC<BreaksLegendProps> = ({\n  legend,\n  isEditing,\n  onEdit,\n  onEditValue,\n  onConfirm,\n  onCancel,\n}) => {\n  if (!legend || legend.length === 0) return null;\n\n  if (!isEditing) {\n    return (\n      <div style={{padding: '8px 12px 0 12px'}}>\n        {onEdit && (\n          <button\n            onClick={onEdit}\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: '4px',\n              background: 'none',\n              border: 'none',\n              color: 'var(--sb-accent, #5b8ef4)',\n              cursor: 'pointer',\n              fontSize: 'var(--sb-font-size-sm, 11px)',\n              padding: '2px 0',\n              marginBottom: '4px',\n            }}\n          >\n            Edit\n          </button>\n        )}\n        {legend.map((item, index) => (\n          <div key={index} style={RowStyle}>\n            <div style={{...SwatchStyle, backgroundColor: item.color}} />\n            <span>{item.label}</span>\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div style={{padding: '8px 12px 0 12px'}}>\n      {legend.map((item, index) => {\n        const isFirst = index === 0;\n        const isLast = index === legend.length - 1;\n        return (\n          <div key={index} style={{...RowStyle, gap: '4px'}}>\n            <div style={{...SwatchStyle, backgroundColor: item.color}} />\n            <ThresholdInput\n              value={item.range[0]}\n              placeholder={isFirst ? 'Less' : undefined}\n              disabled={isFirst}\n              onChange={(val) => onEditValue?.(index, val)}\n            />\n            <span style={{color: 'var(--sb-text-secondary, #6a7485)', padding: '0 2px'}}>\n              &mdash;\n            </span>\n            <ThresholdInput\n              value={item.range[1]}\n              placeholder={isLast ? 'More' : undefined}\n              disabled={isLast}\n              onChange={(val) => onEditValue?.(index, val)}\n            />\n          </div>\n        );\n      })}\n\n      <div\n        style={{\n          display: 'flex',\n          gap: '8px',\n          justifyContent: 'flex-end',\n          padding: '8px 0 4px',\n          borderTop: '1px solid var(--sb-border, #3a4552)',\n          marginTop: '6px',\n        }}\n      >\n        <button\n          onClick={onCancel}\n          style={{\n            background: 'none',\n            border: 'none',\n            color: 'var(--sb-text-secondary, #6a7485)',\n            cursor: 'pointer',\n            fontSize: 'var(--sb-font-size-sm, 11px)',\n            padding: '4px 8px',\n          }}\n        >\n          Cancel\n        </button>\n        <button\n          onClick={onConfirm}\n          style={{\n            background: 'var(--sb-accent, #5b8ef4)',\n            border: 'none',\n            color: '#fff',\n            cursor: 'pointer',\n            fontSize: 'var(--sb-font-size-sm, 11px)',\n            padding: '4px 12px',\n            borderRadius: '3px',\n          }}\n        >\n          Confirm\n        </button>\n      </div>\n    </div>\n  );\n};\n","import React, {useCallback, useEffect} from 'react';\nimport type {ClassificationMethod, BreakLegendEntry, HexColor, PaletteConfig} from '../../core/types';\nimport {useClassifier} from '../hooks/useClassifier';\nimport {usePaletteUI} from '../hooks/usePaletteUI';\nimport {MethodSelector} from './MethodSelector';\nimport {PaletteSelector} from './PaletteSelector';\nimport {BreaksLegend} from './BreaksLegend';\n\nexport type ClassifierPanelProps = {\n  data: number[];\n  initialMethod?: ClassificationMethod;\n  initialNClasses?: number;\n  initialPalette?: string;\n  theme?: 'light' | 'dark';\n  onChange?: (result: {\n    method: ClassificationMethod;\n    nClasses: number;\n    breaks: number[];\n    colors: HexColor[];\n    legend: BreakLegendEntry[];\n  }) => void;\n  className?: string;\n  style?: React.CSSProperties;\n};\n\nexport const ClassifierPanel: React.FC<ClassifierPanelProps> = ({\n  data,\n  initialMethod = 'quantile',\n  initialNClasses = 5,\n  initialPalette = 'Blues',\n  theme = 'dark',\n  onChange,\n  className,\n  style,\n}) => {\n  const {\n    breaks,\n    colors,\n    legend,\n    histogram,\n    histogramDomain,\n    method,\n    nClasses,\n    paletteName,\n    reversed,\n    setMethod,\n    setNClasses,\n    setPalette,\n    setReversed,\n    isEditingCustomBreaks,\n    startEditCustomBreaks,\n    editBreakValue,\n    confirmCustomBreaks,\n    cancelCustomBreaks,\n  } = useClassifier({\n    data,\n    method: initialMethod,\n    nClasses: initialNClasses,\n    palette: initialPalette,\n  });\n\n  const {config, setConfig} = usePaletteUI({\n    initialConfig: {steps: initialNClasses},\n  });\n\n  useEffect(() => {\n    onChange?.({method, nClasses, breaks, colors, legend});\n  }, [method, nClasses, breaks, colors, legend, onChange]);\n\n  const handleConfigChange = useCallback(\n    (partial: Partial<PaletteConfig>) => {\n      setConfig(partial);\n      if (partial.steps !== undefined) setNClasses(partial.steps);\n      if (partial.reversed !== undefined) setReversed(partial.reversed);\n    },\n    [setConfig, setNClasses, setReversed]\n  );\n\n  const handleSelectPalette = useCallback(\n    (name: string) => {\n      setPalette(name);\n    },\n    [setPalette]\n  );\n\n  const sectionStyle: React.CSSProperties = {\n    padding: '8px 12px',\n    borderBottom: '1px solid var(--sb-border, #3a4552)',\n  };\n\n  const labelStyle: React.CSSProperties = {\n    fontSize: 'var(--sb-font-size-sm, 11px)',\n    color: 'var(--sb-text-secondary, #6a7485)',\n    textTransform: 'uppercase',\n    letterSpacing: '0.5px',\n    marginBottom: '6px',\n  };\n\n  return (\n    <div\n      className={className}\n      data-theme={theme}\n      style={{\n        backgroundColor: 'var(--sb-bg-primary, #29323c)',\n        borderRadius: 'var(--sb-radius, 4px)',\n        border: '1px solid var(--sb-border, #3a4552)',\n        overflow: 'hidden',\n        fontFamily: 'var(--sb-font-family)',\n        ...style,\n      }}\n    >\n      <div style={sectionStyle}>\n        <div style={labelStyle}>Classification</div>\n        <MethodSelector\n          method={method}\n          bins={histogram}\n          breaks={breaks}\n          legend={legend}\n          colors={colors}\n          histogramDomain={histogramDomain}\n          onSelectMethod={setMethod}\n        />\n      </div>\n\n      <div style={sectionStyle}>\n        <div style={labelStyle}>Color Palette</div>\n        <PaletteSelector\n          selectedPalette={paletteName}\n          config={config}\n          onSelectPalette={handleSelectPalette}\n          onConfigChange={handleConfigChange}\n        />\n      </div>\n\n      {legend.length > 0 && (\n        <div style={{padding: '8px 0'}}>\n          <div style={{...labelStyle, padding: '0 12px'}}>Legend</div>\n          <BreaksLegend\n            legend={legend}\n            isEditing={isEditingCustomBreaks}\n            onEdit={method === 'custom' ? startEditCustomBreaks : undefined}\n            onEditValue={method === 'custom' ? editBreakValue : undefined}\n            onConfirm={method === 'custom' ? confirmCustomBreaks : undefined}\n            onCancel={method === 'custom' ? cancelCustomBreaks : undefined}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n"]}